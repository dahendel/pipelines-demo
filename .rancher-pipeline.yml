stages:
- name: Build Image
  steps:
  - publishImageConfig:
      dockerfilePath: ./Dockerfile
      buildContext: .
      tag: api-demo
      registry: 127.0.0.1:34729
- name: Charts
  steps:
  - publishCatalogConfig:
      path: chart
      catalogTemplate: api-demo
      version: ${CICD_GIT_BRANCH}}
      gitUrl: https://github.com/dahendel/helm-charts-testing.git
      gitBranch: master
      gitAuthor: dahendel
      gitEmail: dustinhendel@gmail.com
    envFrom:
    - sourceName: gh-jenkins
      sourceKey: USERNAME
      targetKey: USERNAME
    - sourceName: gh-jenkins
      sourceKey: PASSWORD
      targetKey: PASSWORD
timeout: 60
notification: {}
